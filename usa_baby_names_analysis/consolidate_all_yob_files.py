import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

files = ["names/yob1881.txt",
"names/yob1880.txt",
"names/yob1889.txt",
"names/yob1888.txt",
"names/yob1887.txt",
"names/yob1886.txt",
"names/yob1885.txt",
"names/yob1884.txt",
"names/yob1883.txt",
"names/yob1882.txt",
"names/yob1897.txt",
"names/yob1896.txt",
"names/yob1895.txt",
"names/yob1894.txt",
"names/yob1893.txt",
"names/yob1892.txt",
"names/yob1891.txt",
"names/yob1890.txt",
"names/yob1903.txt",
"names/yob1902.txt",
"names/yob1901.txt",
"names/yob1900.txt",
"names/yob1899.txt",
"names/yob1898.txt",
"names/yob1908.txt",
"names/yob1907.txt",
"names/yob1906.txt",
"names/yob1905.txt",
"names/yob1904.txt",
"names/yob1912.txt",
"names/yob1911.txt",
"names/yob1910.txt",
"names/yob1909.txt",
"names/yob1915.txt",
"names/yob1914.txt",
"names/yob1913.txt",
"names/yob1917.txt",
"names/yob1916.txt",
"names/yob1919.txt",
"names/yob1918.txt",
"names/yob1921.txt",
"names/yob1920.txt",
"names/yob1924.txt",
"names/yob1923.txt",
"names/yob1922.txt",
"names/yob1926.txt",
"names/yob1925.txt",
"names/yob1928.txt",
"names/yob1927.txt",
"names/yob1931.txt",
"names/yob1930.txt",
"names/yob1929.txt",
"names/yob1933.txt",
"names/yob1932.txt",
"names/yob1935.txt",
"names/yob1934.txt",
"names/yob1937.txt",
"names/yob1936.txt",
"names/yob1940.txt",
"names/yob1939.txt",
"names/yob1938.txt",
"names/yob1942.txt",
"names/yob1941.txt",
"names/yob1945.txt",
"names/yob1944.txt",
"names/yob1943.txt",
"names/yob1947.txt",
"names/yob1946.txt",
"names/yob1950.txt",
"names/yob1949.txt",
"names/yob1948.txt",
"names/yob1952.txt",
"names/yob1951.txt",
"names/yob1954.txt",
"names/yob1953.txt",
"names/yob1956.txt",
"names/yob1955.txt",
"names/yob1958.txt",
"names/yob1957.txt",
"names/yob1960.txt",
"names/yob1959.txt",
"names/yob1962.txt",
"names/yob1961.txt",
"names/yob1964.txt",
"names/yob1963.txt",
"names/yob1966.txt",
"names/yob1965.txt",
"names/yob1967.txt",
"names/yob1969.txt",
"names/yob1968.txt",
"names/yob1970.txt",
"names/yob1972.txt",
"names/yob1971.txt",
"names/yob1973.txt",
"names/yob1974.txt",
"names/yob1975.txt",
"names/yob1976.txt",
"names/yob1977.txt",
"names/yob1978.txt",
"names/yob1979.txt",
"names/yob1980.txt",
"names/yob1981.txt",
"names/yob1982.txt",
"names/yob1983.txt",
"names/yob1984.txt",
"names/yob1985.txt",
"names/yob1986.txt",
"names/yob1987.txt",
"names/yob1988.txt",
"names/yob1989.txt",
"names/yob1990.txt",
"names/yob1991.txt",
"names/yob1992.txt",
"names/yob1993.txt",
"names/yob1994.txt",
"names/yob1995.txt",
"names/yob1996.txt",
"names/yob1997.txt",
"names/yob1998.txt",
"names/yob1999.txt",
"names/yob2000.txt",
"names/yob2001.txt",
"names/yob2002.txt",
"names/yob2003.txt",
"names/yob2004.txt",
"names/yob2005.txt",
"names/yob2006.txt",
"names/yob2007.txt",
"names/yob2008.txt",
"names/yob2009.txt",
"names/yob2010.txt",
"names/yob2011.txt",
"names/yob2012.txt",
"names/yob2013.txt"]

res = pd.DataFrame()

for file_name in files:
    file_data = pd.read_csv(file_name,names=["Name","Sex","Count"])
    total_count = file_data["Count"].sum()
    file_data['Prop'] = file_data['Count']/total_count
    file_data['Year'] = file_name.split("/")[1].split(".")[0].split("yob")[1]
    res = res.append(file_data)
res = res.sort(["Year"])
res.to_csv('names_prop_by_year.csv', index=False)